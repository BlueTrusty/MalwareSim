# Malware Sim

## by <img src="images/Quadri3500px.png" alt="logo" width="120" style="vertical-align:middle"/>

[![Release](https://img.shields.io/github/v/release/BlueTrusty/MalwareSim?include_prereleases)](https://github.com/BlueTrusty/MalwareSim/releases)
[![License](https://img.shields.io/github/license/BlueTrusty/MalwareSim)](https://www.apache.org/licenses/LICENSE-2.0)
[![Issues](https://img.shields.io/github/issues/BlueTrusty/MalwareSim)](https://github.com/BlueTrusty/MalwareSim/issues?q=is%3Aissue+is%3Aopen)
[![Last Commit](https://img.shields.io/github/last-commit/BlueTrusty/MalwareSim)](https://github.com/BlueTrusty/MalwareSim/commits/main)


This tool suite aims at emulating malware behaviour in order to evaluate EDR/EPP performance and detection capabilities. This tool should not present any danger: its behaviour is known because we've coded it from scratch, disclosed the source code, and also have proceeded to security code review.  

The two available tools are:

1. A ransomware emulator
2. An information stealer emulator

## Usage

You can download the binaries: <a href="https://github.com/BlueTrusty/MalwareSim/releases"> here</a>.

Once  downloaded, extract the "stresstest-windows-executable.zip" archive in a directory of your choice, then run the executables. The binaries are standalone, you do not need to install anything else.

After you have run the test, you can simply delete the "testdir" directory that was created as well as the binaries themselves.

## Ransomware emulation
### The first tool is composed of 3 binaries:
* #### Step 1:
``` bash
step_1_create_dummy_files.exe
```
The binary generates dummy files with various extensions (txt, pdf, png, xlsx...), they contain their own path and filename. The dummy files can be found in the "testdir" directory that is created where you run the binary.

* #### Step 2:
``` bash
step_2_encrypt_files.exe
```
This binary encrypts the content with a randomly generated 16 bytes key. It changes the name of the files and modifies the extensions as well. All of the new extensions are known ransomware extensions. In order for the files to be decrypted (optional), the key is stored in a file named "encryption_key.txt" in the same directory as testdir. The original filenames are stored in a pkl file named "original_filenames.pkl" in order to be restored.
*** This step should trigger your EPP/EDR. ***

* #### Step 3 (optional):
``` bash
step_3_decrypt_files.exe
```
This binary decrypts the files and restores their original name and extension.

## Information stealer emulation

This tool requires you to setup a webhook on a private discord server in order to receive the information "stolen" from you. 

You can find a tutorial: <a href="https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks">here</a>.

### The second tool is a standalone binary:

``` bash
steal_information.exe
```

This binary first prompts you to enter the webhook URL. It then proceeds to gather information from your computer and send it to the webhook you provided. The information stolen is the following: ip address, mac address, location, browser history & browser bookmarks.

In a real world scenario, the webhook would be controlled by the attacker. 
Infostealer could also be used to steal cookies, passwords, sensitive files, etc.

## Disclaimer

This tool suite is not intended for malicious use. It is intended to be used for educational and testing purposes only.
If you use this script for malicious purposes, you are breaking the law.

## Learn more

This test is included in our "ransomware stress-test" service ; you can learn more about it here: <a href="https://stresstest.bluetrusty.com/">https://stresstest.bluetrusty.com/</a>.
